let map;
let marker;
let autocomplete;

function initMap() {
  const initialPosition = { lat: -19.93516, lng: -43.93105 };

  map = new google.maps.Map(document.getElementById("map"), {
    center: initialPosition,
    zoom: 15,
  });

  marker = new google.maps.Marker({
    position: initialPosition,
    map: map,
    title: "Bloco Filhos da PUC-MG",
    label: {
      text: "Bloco Filhos da PUC-MG",
      color: "#d32f2f",
      fontWeight: "bold",
      fontSize: "14px",
    },
    icon: {
      url: "http://maps.google.com/mapfiles/ms/icons/red-dot.png",
      labelOrigin: new google.maps.Point(20, -10),
    },
  });

  const input = document.getElementById("brpesquisa");

  autocomplete = new google.maps.places.Autocomplete(input, {
    types: ["geocode"],
    componentRestrictions: { country: "br" },
    fields: ["geometry", "name"],
  });

  autocomplete.addListener("place_changed", handlePlaceSelection);
}

function handlePlaceSelection() {
  const place = autocomplete.getPlace();

  if (!place.geometry || !place.geometry.location) {
    alert("Local n√£o encontrado!");
    return;
  }

  const location = place.geometry.location;

  map.setCenter(location);
  map.setZoom(17);
  marker.setPosition(location);
  marker.setTitle(place.name);
  marker.setLabel({
    text: place.name,
    color: "#c0392b",
    fontWeight: "bold",
    fontSize: "14px",
  });
}
